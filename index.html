<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Late Monitoring system</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        <div id="login-page">
            <h1>A.A.N.M.&V.V.R.S.R. POLYTECHNIC, GUDLAVALLERU</h1>
            <h2>Student Campus Login</h2>
            <form id="login-form">
                <div class="form-group"><label for="email">Email:</label><input type="email" id="email" required></div>
                <div class="form-group"><label for="password">Password:</label><input type="password" id="password" required></div>
                <button type="submit" id="login-button">Login</button>
                <p id="login-error" class="error-message"></p>
            </form>
        </div>

        <div id="app-container" style="display: none;">
            <header class="app-header">
                <div id="user-info"></div>
                <button id="logout-button">Logout</button>
            </header>
        </div>
        
        <div id="admin-dashboard" class="dashboard main-content">
            <h2>Admin Dashboard</h2>
            <h3>Financial Summary</h3>
            <div id="admin-fine-summary">Loading summary...</div>
            
            <h3>Login History</h3>
            <div id="admin-login-history" class="student-list-container">Loading login history...</div>
            
            <h3 style="margin-top: 30px;">Daily Late Students Report</h3>
            <div class="form-group">
                <label for="admin-report-date">Select Date:</label>
                <input type="date" id="admin-report-date">
            </div>
            <button id="download-late-report-btn" class="action-button">Download Daily Report (Excel)</button>
            <p id="admin-report-message" style="margin-top: 10px;"></p>

            <h3 style="margin-top: 30px;">Monthly Late Students Summary Report</h3>
            <div class="form-group">
                <label for="admin-monthly-report-month">Select Month:</label>
                <input type="month" id="admin-monthly-report-month">
            </div>
            <button id="download-monthly-report-btn" class="action-button">Download Monthly Summary (Excel)</button>
            <p id="admin-monthly-report-message" style="margin-top: 10px;"></p>
        </div>

        <div id="supervisor-dashboard" class="dashboard">
             <h2>Supervisor Dashboard</h2>
            <h3>Mark Late Students</h3>
            <div class="form-row">
                <div class="form-group"><label for="filter-branch">Branch:</label>
                    <select id="filter-branch">
                        <option value="MECH">MECH</option><option value="EEE">EEE</option><option value="ECE">ECE</option><option value="AIML">AIML</option><option value="CIOT">CIOT</option><option value="CME">CME</option><option value="CIVIL">CIVIL</option>
                    </select>
                </div>
                <div class="form-group"><label for="filter-year">Year:</label><select id="filter-year"><option value="1">1st Year</option><option value="2">2nd Year</option><option value="3">3rd Year</option></select></div>
            </div>
            <div class="form-row">
                <div class="form-group"><label for="late-date">Date:</label><input type="date" id="late-date"></div>
                <div class="form-group"><label for="late-session">Session:</label><select id="late-session"><option value="FN">Morning (FN)</option><option value="AN">Afternoon (AN)</option></select></div>
            </div>
            <div class="form-group"><label for="late-type">Late Type:</label><select id="late-type"><option value="Gate">Gate</option><option value="Canteen">Canteen</option></select></div>
            <div class="form-group"><label for="quick-entry">Quick Entry (comma-separated last digits):</label><input type="text" id="quick-entry"></div>
            <div class="form-group"><label>Select Students from List:</label><div id="student-list-checkbox" class="student-list-container"></div></div>
            <button id="mark-late-button">Mark Selected Students as Late</button>
            <p id="mark-late-message" style="text-align: center; margin-top: 15px;"></p>
            <div id="fine-summary-container" style="display: none;"></div>
            <hr>

            <h3>Review & Remove Late Entries</h3>
            <div class="form-row">
                <div class="form-group">
                    <label for="review-date">Select Date:</label>
                    <input type="date" id="review-date">
                </div>
                <div class="form-group">
                    <label for="review-late-type">Late Type:</label>
                    <select id="review-late-type">
                        <option value="Gate">Gate</option>
                        <option value="Canteen">Canteen</option>
                    </select>
                </div>
            </div>
            <button id="fetch-late-entries-btn">Fetch Entries</button>
            <div id="review-results-container" style="margin-top: 15px;"></div>
            <hr>
            <h3>Check Fined Students by Month</h3>
            <div class="form-row">
                <div class="form-group">
                    <label for="history-branch-select">Select Branch:</label>
                    <select id="history-branch-select">
                        <option value="MECH">MECH</option><option value="EEE">EEE</option><option value="ECE">ECE</option><option value="AIML">AIML</option><option value="CIOT">CIOT</option><option value="CME">CME</option><option value="CIVIL">CIVIL</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="history-month-select">Select Month:</label>
                    <input type="month" id="history-month-select">
                </div>
            </div>
            <button id="check-history-btn">Check Fined Students</button>
            <div id="history-results-display" style="margin-top: 15px;"></div>
        </div>
        
        <div id="mech-dashboard" class="dashboard">
            <h2>MECH Branch - Fine Status</h2>
            <div class="form-group"><label for="mech-year-filter">Filter by Year:</label><select id="mech-year-filter"><option value="">All Years</option><option value="1">1st Year</option><option value="2">2nd Year</option><option value="3">3rd Year</option></select></div>
            <div id="mech-results"></div>
            <div id="mech-impose-fine-container"></div> 
        </div>
        <div id="eee-dashboard" class="dashboard">
            <h2>EEE Branch - Fine Status</h2>
            <div class="form-group"><label for="eee-year-filter">Filter by Year:</label><select id="eee-year-filter"><option value="">All Years</option><option value="1">1st Year</option><option value="2">2nd Year</option><option value="3">3rd Year</option></select></div>
            <div id="eee-results"></div>
            <div id="eee-impose-fine-container"></div> 
        </div>
        <div id="ece-dashboard" class="dashboard">
            <h2>ECE Branch - Fine Status</h2>
            <div class="form-group"><label for="ece-year-filter">Filter by Year:</label><select id="ece-year-filter"><option value="">All Years</option><option value="1">1st Year</option><option value="2">2nd Year</option><option value="3">3rd Year</option></select></div>
            <div id="ece-results"></div>
            <div id="ece-impose-fine-container"></div> 
        </div>
        <div id="aiml-dashboard" class="dashboard">
            <h2>AIML Branch - Fine Status</h2>
            <div class="form-group"><label for="aiml-year-filter">Filter by Year:</label><select id="aiml-year-filter"><option value="">All Years</option><option value="1">1st Year</option><option value="2">2nd Year</option><option value="3">3rd Year</option></select></div>
            <div id="aiml-results"></div>
            <div id="aiml-impose-fine-container"></div> 
        </div>
        <div id="ciot-dashboard" class="dashboard">
            <h2>CIOT Branch - Fine Status</h2>
            <div class="form-group"><label for="ciot-year-filter">Filter by Year:</label><select id="ciot-year-filter"><option value="">All Years</option><option value="1">1st Year</option><option value="2">2nd Year</option><option value="3">3rd Year</option></select></div>
            <div id="ciot-results"></div>
            <div id="ciot-impose-fine-container"></div> 
        </div>
        <div id="cme-dashboard" class="dashboard">
            <h2>CME Branch - Fine Status</h2>
            <div class="form-group"><label for="cme-year-filter">Filter by Year:</label><select id="cme-year-filter"><option value="">All Years</option><option value="1">1st Year</option><option value="2">2nd Year</option><option value="3">3rd Year</option></select></div>
            <div id="cme-results"></div>
            <div id="cme-impose-fine-container"></div> 
        </div>
        <div id="civil-dashboard" class="dashboard">
            <h2>CIVIL Branch - Fine Status</h2>
            <div class="form-group"><label for="civil-year-filter">Filter by Year:</label><select id="civil-year-filter"><option value="">All Years</option><option value="1">1st Year</option><option value="2">2nd Year</option><option value="3">3rd Year</option></select></div>
            <div id="civil-results"></div>
            <div id="civil-impose-fine-container"></div> 
        </div>

        <div id="office-dashboard" class="dashboard">
            <h2>Office Dashboard - Collect Fines</h2>
            <div class="form-row">
                 <div class="form-group"><label for="office-filter-branch">Branch:</label>
                    <select id="office-filter-branch">
                        <option value="MECH">MECH</option><option value="EEE">EEE</option><option value="ECE">ECE</option><option value="AIML">AIML</option><option value="CIOT">CIOT</option><option value="CME">CME</option><option value="CIVIL">CIVIL</option>
                    </select>
                </div>
                <div class="form-group"><label for="office-filter-year">Year:</label><select id="office-filter-year"><option value="1">1st Year</option><option value="2">2nd Year</option><option value="3">3rd Year</option></select></div>
            </div>
            <button id="office-fetch-fines-btn">Fetch Fines</button>
            <div id="office-results"></div>
        </div>

        <div id="principal-dashboard" class="dashboard">
            <h2>Principal's Dashboard</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="principal-filter-branch">Filter by Branch:</label>
                    <select id="principal-filter-branch">
                        <option value="">All Branches</option><option value="MECH">MECH</option><option value="EEE">EEE</option><option value="ECE">ECE</option><option value="AIML">AIML</option><option value="CIOT">CIOT</option><option value="CME">CME</option><option value="CIVIL">CIVIL</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="principal-filter-year">Filter by Year:</label>
                    <select id="principal-filter-year">
                        <option value="">All Years</option><option value="1">1st Year</option><option value="2">2nd Year</option><option value="3">3rd Year</option>
                    </select>
                </div>
            </div>
            <div id="principal-results"></div>
            <div id="principal-impose-fine-container"></div> 
            
            <h3 style="margin-top: 30px;">Monthly Late Students Summary Report</h3>
            <div class="form-group">
                <label for="principal-monthly-report-month">Select Month:</label>
                <input type="month" id="principal-monthly-report-month">
            </div>
            <button id="principal-download-monthly-report-btn" class="action-button">Download Monthly Summary (Excel)</button>
            <p id="principal-monthly-report-message" style="margin-top: 10px;"></p>
        </div>
    </div>

    <footer class="main-footer w-full bg-gray-900 text-white text-center py-4 mt-10 shadow-md">
        <p class="text-sm">
          Design & Developed by <span class="font-semibold text-blue-400">K. LAKSHMANA RAO</span>
        </p>
        <p class="text-xs text-gray-400 mt-1">
          Faculty, A.A.N.M. & V.V.R.S.R. Polytechnic, Gudlavalleru
        </p>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="config.js"></script>
    <script src="script.js"></script>
</body>
</html>